//! Generates shared route constants for the frontend.
//!
//! Run with: cargo run --bin export_types

use std::fs;
use std::path::Path;

use redgrouse::api_constants;

fn main() {
    let out_dir = Path::new("../frontend/src/lib/generated");
    fs::create_dir_all(out_dir).expect("Failed to create output directory");

    let constants_content = format!(
        "// Auto-generated by backend/src/bin/export_types.rs\n\
         // Do not edit manually\n\n\
         export const HEALTH_ROUTE = \"{}\";\n\
         export const VERSION_ROUTE = \"{}\";\n\
         export const UPLOAD_ROUTE = \"{}\";\n\
         export const UPLOAD_DETAILS_ROUTE = \"{}\";\n\
         export const UPLOAD_COUNT_ROUTE = \"{}\";\n\
         export const UPLOAD_BBOX_ROUTE = \"{}\";\n\
         export const UPLOAD_SIGHTINGS_ROUTE = \"{}\";\n\
         export const UPLOAD_STATS_ROUTE = \"{}\";\n\
         export const TILE_ROUTE = \"{}\";\n\
         export const FIELDS_ROUTE = \"{}\";\n\
         export const FIELD_VALUES_ROUTE = \"{}\";\n\
         export const DEFAULT_PAGE_SIZE = {};\n\
         export const MAX_PAGE_SIZE = {};\n",
        api_constants::HEALTH_ROUTE,
        api_constants::VERSION_ROUTE,
        api_constants::UPLOAD_ROUTE,
        api_constants::UPLOAD_DETAILS_ROUTE,
        api_constants::UPLOAD_COUNT_ROUTE,
        api_constants::UPLOAD_BBOX_ROUTE,
        api_constants::UPLOAD_SIGHTINGS_ROUTE,
        api_constants::UPLOAD_STATS_ROUTE,
        api_constants::TILE_ROUTE,
        api_constants::FIELDS_ROUTE,
        api_constants::FIELD_VALUES_ROUTE,
        api_constants::DEFAULT_PAGE_SIZE,
        api_constants::MAX_PAGE_SIZE
    );

    fs::write(out_dir.join("api_constants.ts"), constants_content)
        .expect("Failed to write api_constants.ts");
}
