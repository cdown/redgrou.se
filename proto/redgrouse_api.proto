syntax = "proto3";

package redgrouse.api;

message ApiErrorBody {
  string error = 1;
  optional string code = 2;
}

message UploadMetadata {
  string upload_id = 1;
  string filename = 2;
  int64 row_count = 3;
  string title = 4;
}

message UploadResponse {
  string upload_id = 1;
  string filename = 2;
  int64 row_count = 3;
  string edit_token = 4;
  string title = 5;
}

message UpdateResponse {
  string upload_id = 1;
  string filename = 2;
  int64 row_count = 3;
  string title = 4;
}

message DeleteResponse {
  bool deleted = 1;
}

message CountResponse {
  int64 count = 1;
}

message FieldMetadata {
  string name = 1;
  string label = 2;
  string field_type = 3;
}

message FieldMetadataList {
  repeated FieldMetadata fields = 1;
}

message FieldValues {
  string field = 1;
  repeated string values = 2;
}

message BboxResponse {
  double min_lng = 1;
  double min_lat = 2;
  double max_lng = 3;
  double max_lat = 4;
}

message Species {
  string common_name = 1;
  optional string scientific_name = 2;
}

message Sighting {
  int64 id = 1;
  optional uint32 common_name_index = 2;
  optional int64 count = 3;
  double latitude = 4;
  double longitude = 5;
  optional string country_code = 6;
  optional string region_code = 7;
  string observed_at = 8;
}

message GroupedSighting {
  optional uint32 common_name_index = 1;
  optional string country_code = 2;
  optional string observed_at = 3;
  int64 count = 4;
  int64 species_count = 5;
}

message SightingsResponse {
  repeated Species name_index = 1;
  repeated Sighting sightings = 2;
  repeated GroupedSighting groups = 3;
  int64 total = 4;
  uint32 page = 5;
  uint32 page_size = 6;
  uint32 total_pages = 7;
}

message VersionInfo {
  string git_hash = 1;
  string build_date = 2;
  string rustc_version = 3;
}
